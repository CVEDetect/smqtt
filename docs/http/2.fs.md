---
sort: 2 
---

# http内置接口




- ##推送消息接口

> 系统内置了io.github.quickmsg.core.http.PublishActor接口，用于推送mqtt消息。使用方式如下：

- 请求url /smqtt/publish
- 请求方式 POST
- 请求Body

|  参数   | 说明  | 必传  |
|  ----  | ----  |----  |
| topic  | topiuc |是 |
| qos  | 服务等级 |是 |
| retain  | 保留消息 |是 |
| message  | 消息 |是 |

- 返回body
空
- 返回状态码
200 成功


```
curl -H "Content-Type: application/json" -X POST -d '{"topic": "test/teus", "qos":2, "retain":true, "message":"我来测试保留消息3" }' "http://localhost:1999/smqtt/publish"
```


- ##获取当前连接

> 系统内置了io.github.quickmsg.core.http.ConnectionActor，用于获取当前连接。使用方式如下：

- 请求url /smqtt/connection
- 请求方式 POST
- 请求Body
  无
- 返回Body

|  参数   | 说明  | 必传  |
|  ----  | ----  |----  |
| connection  | 连接 |是 |
| status  | 状态 |是 |
| activeTime  | 激活时间 |是 |
| authTime  | 认证时间 |是 |
| sessionPersistent  | session开启 |是 |
| will  | 遗嘱消息 |是 |
| keepalive  | 心跳时间 |是 |
| topics  | 订阅topic |是 |

```markdown
[
    {
        "activeTime": 1624113398783,
        "authTime": 1624113398805,
        "clientIdentifier": "mqttx_20fe13251",
        "connection": {
            "disposed": false,
            "inboundCancelled": false,
            "inboundDisposed": false,
            "persistent": true,
            "subscriptionDisposed": false
        },
        "keepalive": 60,
        "sessionPersistent": true,
        "status": "ONLINE",
        "topics": [],
        "will": {
            "mqttQoS": "AT_MOST_ONCE",
            "retain": false,
            "willMessage": "YXNkbmJsa2hhc2Jk",
            "willTopic": "test/close"
        }
    }
]

```
- 发送请求

```
curl -H "Content-Type: application/json" -X POST "http://localhost:1999/smqtt/connection"
```



- ##获取当前集群信息

> 系统内置了io.github.quickmsg.core.http.actors.ClusterActor，用于获取当前连接。使用方式如下：

- 请求url /smqtt/cluster
- 请求方式 POST
- 请求Body
  无
- 返回Body

|  参数   | 说明  | 必传  |
|  ----  | ----  |----  |
| alias  | node名称 |是 |
| host  | 主机ip |是 |
| port  | 端口 |是 |
| namespace  | 命名空间 |是 |

```markdown
[
    {
        "alias": "node-4",
        "host": "169.254.122.50",
        "namespace": "default",
        "port": 7771
    },
    {
        "alias": "node-3",
        "host": "169.254.122.50",
        "namespace": "default",
        "port": 7772
    },
    {
        "alias": "node-2",
        "host": "169.254.122.50",
        "namespace": "default",
        "port": 7773
    }
]
```


- 发送请求

```
curl -H "Content-Type: application/json" -X POST "http://localhost:1999/smqtt/cluster"
```

- ##获取当前订阅信息

> 系统内置了io.github.quickmsg.core.http.actors.SubscribeActor，用于获取当前连接。使用方式如下：

- 请求url /smqtt/subscribe
- 请求方式 POST
- 请求Body
  无
- 返回Body

|  参数   | 说明  | 必传  |
|  ----  | ----  |----  |
| activeTime  | 激活時間 |是 |
| authTime  | 认证时间 |是 |
| clientIdentifier  | 客户端id |是 |
| keepalive  | 心跳时间 |是 |
| sessionPersistent   | 是否持久化 |是 |
| status  | 在线状态 |是 |
| topics  | 订阅topic |是 |


```markdown
{
    "test/+": [
        {
            "activeTime": 1624110181885,
            "authTime": 1624110181923,
            "clientIdentifier": "client-id-3",
            "connection": {
                "disposed": false,
                "inboundCancelled": false,
                "inboundDisposed": false,
                "persistent": true,
                "subscriptionDisposed": false
            },
            "keepalive": 20,
            "sessionPersistent": true,
            "status": "ONLINE",
            "topics": [
                "test/+"
            ]
        }
    ]
}
```

- 发送请求

```
curl -H "Content-Type: application/json" -X POST "http://localhost:1999/smqtt/cluster"
```